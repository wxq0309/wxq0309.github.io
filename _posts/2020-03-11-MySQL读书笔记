---
  title: MySQL读书笔记
  author: 何大仙
---

### MySQL分层架构

```
Server层：涵盖MySQL大多数的核心功能，以及内置函数如存储过程、触发器、视图等
存储引擎：负责数据的存储和提取

其中Server层可划分为：
  连接器： 负责跟客户端建立连接、获取权限、维持和管理连接
          mysql -h ip -P port -u name -p password
  
          show processlist; 查看链接 默认八小时的连接时间 wait_timeout控制
          长链接：连接成功后，客户端持续有请求，使用同一连接。
          短链接：每次执行完很少的几次操作就断开。
          推荐使用长连接 —— MySQL占用内存大 

  查询缓存： 执行查询命令之前，MySQL会先到缓存中查看，如果存在返回k-v，k为查询语句，v为查询结果
            如果不存在，继续往下执行，并把结果缓存到内存中
            
            推荐不使用查询缓存，因为查询缓存失效频繁，如果对一个表更新，那么找个表的所有的查询缓存都会被清除
            
            通过设置 query_cache_type=DEMAND 即不使用查询缓存
            设置 SQL_CACHE 显式指定
            
            select SQL_CAHCHE * from T where id=1;
            
  分析器： 如果没有命中查询缓存，则需要对SQL语句解析，分析SQL语句语法是否正确
  
  优化器： 经过分析器后，还需要经过优化器优化决定使用那个索引 多表关联的时候 每个表的顺序
  
  执行器： 经过优化器，MySQL开始执行SQL语句
```


